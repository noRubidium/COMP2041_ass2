<div id="password_recover">
</div>
<script type="text/babel">
	var Password_recover = React.createClass({{
		getInitialState: function(){{
			return {{
				valid:false,
				key:{0},
				username:"{1}"
			}};
		}},
		changeHandle: function(){{
			var password = this.refs.password.value;
			var password_confirm = this.refs.password_confirm.value;
			var re=/^[\w\-\s]{{6,16}}$/;
			if(password.search(re) != -1 && password_confirm === password){{
				this.setState({{valid:true}});
				console.log("lol");
			}}else{{
				this.setState({{valid:false}});
			}}
			if(this.refs.username.value != this.state.username){{
				this.setState({{valid:false}});
			}}
			console.log(this.state.valid);
		}},
		render: function(){{
			return(
				<div 
					className="row">
					<div 
						id="passwordChangingForm"
						className="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3 thumbnail">
						<h2>
							Change your password
						</h2>
						<form 
							action="password_recovery.cgi">
							<input
								type="hidden"
								name="key"
								ref="key"
								value="{0}"/>
							<input
								type="hidden"
								name="username"
								ref="username"
								value="{1}"/>
							<div 
								className="form-group">
								<label>
									Password
								</label>
								<input 
									type="password" 
									name="password" 
									className="form-control" 
									onChange={{this.changeHandle}} 
									ref="password" 
									defaultValue=""
									placeholder="Password"/>
								<p 
									className="help-block">
									At least 8 digits, at most 16 digits
								</p>
							</div>
							<div 
								className="form-group">
								<label>
									Confirm password
								</label>
								<input 
									type="password" 
									className="form-control" 
									onChange={{this.changeHandle}} 
									ref="password_confirm" 
									defaultValue=""
									placeholder="" />
								<p 
									className="help-block">
									Must be the same as the previous section
								</p>
							</div>
							{{this.state.valid
								?<button 
									className="btn btn-disable"
									name="action" 
									value="change_password">
									Change your password
								</button>
								:<button 
									className="btn btn-default"
									disabled>
									Change your password
								</button>
							}}
							<a 
								href='bitter.cgi'>
								Back to front page 
							</a>
						</form>
					</div>
				</div>
			);
		}}
	}});
	ReactDOM.render(
		<Password_recover />,
		document.getElementById("password_recover"));
</script>
